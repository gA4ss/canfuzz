# 介绍
本子模块的主要作用是对CAN总线进行模糊测试。

# 动作参数

|名称|类型|默认值|描述|
|---|----|-----|---|
|"id"|列表,整型|*[0, 1, 2, 111, 333, [334, 339]]*|要进行发送的的CANID列表。如果是 *[2,10]* ，这样的形式，则表示一个范围|
|"mode"|字符串|*[ISOTP](../isotp.md),[CAN](../can.md)*|包模式|
|"data"|列表，整型|无|基础数据，index字段范围不能超过此数据模板。|
|"index"|列表，整型|无|要进行改变，基础数据的索引。不能超过data的长度范围。如果为空，则采用"data"的全部数据。|
|"bytes"|列表，整型，二元组|无|要进行填充数值的范围，用此数据来填充data模板。如果为空，则默认生成*[0,255]* 的数据队列。|
|"delay"|整型|0|发送数据的延迟。|

# 工作原理

在`do_effect`函数中，如果发现当前的fuzz数据为空，则调用`fuzz`函数按照参数中定义的模板进行随机填充，在管道中上没有任何数据时，将fuzz数据输出到管道中。

# 模糊数据构造规则
模糊引擎有两种模糊测试数据，一种是随机的CAN总线数据，一种是基于构造的随机数据来构造[ISOTP](../isotp.md)协议数据。具体
在动作参数中"id"表示要发送CANID集合，在动作参数输入时如果 *[334, 339]]* 的形式表示334-339范围内的CANID。"data"字段是基础数据，所有模糊数据都是在此数据上进行变换。"index"是一个索引列表对应了"data"数据中要变换的区域，例如：`"data" = [20,83,12,10,11,93,06,13]`，而`"index" = [3,5,7]`，那么在生成数据时，会改变"data"的3,5,7索引处的数据。"bytes"是要填充的数据，如果`"bytes = [101,147]"`，那么以上会进行一系列排列组合。将"data"中的"3,5,7"索引处的数据，依次替换成"101"和"147"。这样就变成了6组数据。最后如果"mode"选定的是[ISOTP](../isotp.md)则使用ISOTP标准来构建，如果是[CAN](../can.md)则使用原始CAN包进行构建。